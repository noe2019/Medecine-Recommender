<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AI Health Care Center</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .form-container {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">AI Doctor</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <!-- <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li> -->
                </ul>
            </div>
        </div>
    </nav>
    

    <!-- Main Content -->
    <div class="container">
        <h1 class="text-center text-success mb-4">Tell us about your symptoms</h1>
        <div class="form-container">
            <form action="/predict" method="post">
                <div class="mb-3 position-relative">
                    <label for="symptom-input" class="form-label">Select Symptoms:</label>
                    <input type="text" id="symptom-input" class="form-control" autocomplete="off" placeholder="Start typing a symptom...">
                    <div id="autocomplete-list" class="autocomplete-dropdown"></div>
                </div>
            
                <ul id="selected-symptoms" class="list-group mb-3"></ul>
            
                <!-- Hidden input to send selected symptoms -->
                <input type="hidden" name="symptoms" id="symptoms-hidden-input">
            
                <button type="button" id="add-symptom" class="btn btn-primary mb-2">Add Symptom</button>
                <button type="submit" class="btn btn-danger">Get Diagnosis</button>
            </form>
            
            <!-- Results Section -->
            <!-- Results Section -->
{% if predicted_disease %}
<div class="mt-5">
    <h2>Diagnosis Results</h2>
    <p><strong>Predicted Disease:</strong> {{ predicted_disease }}</p>
    <p><strong>Description:</strong> {{ dis_des }}</p>

    <h4>Medications:</h4>
    <ul>
        {% for medication in medications %}
        <li>{{ medication }}</li>
        {% endfor %}
    </ul>

    <h4>Suggestions:</h4>
    <ul>
        {% for workout in workout %}
        <li>{{ workout }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

            

    <!-- JavaScript -->
    <script>
        const symptoms = {{ unique_symptoms | tojson }};
const inputField = document.getElementById('symptom-input');
const autocompleteList = document.getElementById('autocomplete-list');
const selectedSymptomsList = document.getElementById('selected-symptoms');
const symptomsHiddenInput = document.getElementById('symptoms-hidden-input');

let selectedSymptoms = [];

// Autocomplete functionality
inputField.addEventListener('input', () => {
    const query = inputField.value.toLowerCase();
    autocompleteList.innerHTML = ''; // Clear the dropdown

    if (query) {
        const filteredSymptoms = symptoms.filter(symptom =>
            symptom.toLowerCase().includes(query) && !selectedSymptoms.includes(symptom)
        );

        filteredSymptoms.forEach(symptom => {
            const item = document.createElement('div');
            item.className = 'autocomplete-item';
            item.textContent = symptom;

            // Add symptom on click
            item.addEventListener('click', () => {
                addSymptomToList(symptom); // Add selected symptom
                inputField.value = ''; // Clear input
                autocompleteList.innerHTML = ''; // Clear dropdown
            });

            autocompleteList.appendChild(item);
        });
    }
});

// Add a symptom to the selected list
function addSymptomToList(symptom) {
    if (!selectedSymptoms.includes(symptom)) {
        selectedSymptoms.push(symptom);

        // Update hidden input field
        symptomsHiddenInput.value = selectedSymptoms.join(',');

        const listItem = document.createElement('li');
        listItem.className = 'list-group-item d-flex justify-content-between align-items-center';
        listItem.textContent = symptom;

        const removeButton = document.createElement('button');
        removeButton.className = 'btn btn-danger btn-sm';
        removeButton.textContent = 'Remove';

        removeButton.addEventListener('click', () => {
            selectedSymptoms = selectedSymptoms.filter(s => s !== symptom);
            symptomsHiddenInput.value = selectedSymptoms.join(',');
            listItem.remove();
        });

        listItem.appendChild(removeButton);
        selectedSymptomsList.appendChild(listItem);
    }
}

// Close dropdown if clicking outside
document.addEventListener('click', (event) => {
    if (!autocompleteList.contains(event.target) && event.target !== inputField) {
        autocompleteList.innerHTML = '';
    }
});
    </script>
</body>
</html>